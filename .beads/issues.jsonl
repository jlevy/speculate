{"id":"speculate-1d3","title":"Implement _setup_claude_plugin() function","description":"Add main function to set up .claude/plugins/speculate/:\n\nKey responsibilities:\n1. Collect shortcuts from docs/general/agent-shortcuts/, docs/general/agent-setup/, docs/project/agent-shortcuts/\n2. Create directory structure (.claude-plugin/, commands/, skills/speculate-workflow/)\n3. Generate and write plugin.json\n4. Create symlinks for each shortcut (stripping 'shortcut:' prefix)\n5. Generate and write SKILL.md routing skill\n6. Apply include/exclude pattern filtering\n7. Handle force flag for overwriting existing files\n\nSymlink path calculation: 5 levels up from commands/ directory.\n\nSee plan spec for complete implementation code.\n\n**Files**: cli/src/speculate/cli/cli_commands.py\n**Spec**: cli/docs/project/specs/active/plan-2026-01-03-claude-code-plugin-support.md\n**Depends on**: speculate-8qa, speculate-jnv (generator functions)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T21:14:57.234500648Z","created_by":"Claude","updated_at":"2026-01-03T21:14:57.234500648Z","dependencies":[{"issue_id":"speculate-1d3","depends_on_id":"speculate-8qa","type":"blocks","created_at":"2026-01-03T21:14:57.250976576Z","created_by":"unknown"},{"issue_id":"speculate-1d3","depends_on_id":"speculate-jnv","type":"blocks","created_at":"2026-01-03T21:14:57.258368523Z","created_by":"unknown"}]}
{"id":"speculate-1tq","title":"Add tests for Claude Code plugin functionality","description":"Add unit and integration tests for the new Claude Code plugin functionality:\n\n1. Test _generate_plugin_json():\n   - Verify JSON structure\n   - Verify content matches constants\n\n2. Test _generate_skill_md():\n   - Verify SKILL.md frontmatter format\n   - Verify trigger table is generated\n   - Verify workflow chains are included\n\n3. Test _setup_claude_plugin():\n   - Creates correct directory structure\n   - Symlinks are created with correct names (shortcut: prefix stripped)\n   - Symlinks point to correct targets\n   - Include/exclude patterns work\n   - Force flag overwrites existing files\n   - Handles missing shortcuts directories gracefully\n\n4. Test _remove_claude_plugin():\n   - Removes plugin directory\n   - Cleans up empty parent directories\n   - Leaves other .claude content alone\n\n5. Integration tests:\n   - install() creates plugin\n   - uninstall() removes plugin\n   - status() reports plugin status\n\n**Files**: cli/tests/test_cli_commands.py (or new test file)\n**Spec**: cli/docs/project/specs/active/plan-2026-01-03-claude-code-plugin-support.md\n**Depends on**: All integration beads complete","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T21:16:26.790504548Z","created_by":"Claude","updated_at":"2026-01-03T21:16:26.790504548Z","dependencies":[{"issue_id":"speculate-1tq","depends_on_id":"speculate-30r","type":"blocks","created_at":"2026-01-03T21:16:26.805783628Z","created_by":"unknown"},{"issue_id":"speculate-1tq","depends_on_id":"speculate-y1t","type":"blocks","created_at":"2026-01-03T21:16:26.813153853Z","created_by":"unknown"},{"issue_id":"speculate-1tq","depends_on_id":"speculate-afk","type":"blocks","created_at":"2026-01-03T21:16:26.815939932Z","created_by":"unknown"}]}
{"id":"speculate-30r","title":"Integrate _setup_claude_plugin into install() command","description":"Modify install() function to call _setup_claude_plugin():\n\nAdd after the existing _setup_cursor_rules() call (~line 250):\n\n```python\ndef install(...) -\u003e None:\n    # ... existing code ...\n    \n    # .cursor/rules/\n    _setup_cursor_rules(cwd, include=include, exclude=exclude, force=force)\n    \n    # NEW: .claude/plugins/speculate/\n    _setup_claude_plugin(cwd, include=include, exclude=exclude, force=force)\n    \n    # ... rest of existing code ...\n```\n\n**Files**: cli/src/speculate/cli/cli_commands.py\n**Spec**: cli/docs/project/specs/active/plan-2026-01-03-claude-code-plugin-support.md\n**Depends on**: speculate-1d3 (_setup_claude_plugin function)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T21:15:29.235546361Z","created_by":"Claude","updated_at":"2026-01-03T21:15:29.235546361Z","dependencies":[{"issue_id":"speculate-30r","depends_on_id":"speculate-1d3","type":"blocks","created_at":"2026-01-03T21:15:29.257220514Z","created_by":"unknown"}]}
{"id":"speculate-49r","title":"Update install() docstring to mention Claude Code plugin","description":"Update the install() docstring to document the new Claude Code plugin setup:\n\n```python\ndef install(...) -\u003e None:\n    \"\"\"Generate tool configs for Cursor, Claude Code, and Codex.\n\n    Creates or updates:\n      - .speculate/settings.yml (install metadata)\n      - CLAUDE.md (for Claude Code) — adds speculate header if missing\n      - AGENTS.md (for Codex) — adds speculate header if missing\n      - .cursor/rules/ (symlinks for Cursor)\n      - .claude/plugins/speculate/ (Claude Code plugin with commands and skill)  # NEW\n\n    ...existing docstring...\n    \"\"\"\n```\n\n**Files**: cli/src/speculate/cli/cli_commands.py","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T21:16:08.70010726Z","created_by":"Claude","updated_at":"2026-01-03T21:16:08.70010726Z","dependencies":[{"issue_id":"speculate-49r","depends_on_id":"speculate-30r","type":"blocks","created_at":"2026-01-03T21:16:08.717844397Z","created_by":"unknown"}]}
{"id":"speculate-8qa","title":"Implement _generate_plugin_json() function","description":"Add function to generate plugin.json content:\n\n```python\ndef _generate_plugin_json() -\u003e str:\n    \"\"\"Generate plugin.json content for the Speculate plugin.\"\"\"\n    plugin_data = {\n        \"name\": CLAUDE_PLUGIN_NAME,\n        \"version\": CLAUDE_PLUGIN_VERSION,\n        \"description\": CLAUDE_PLUGIN_DESCRIPTION,\n        \"author\": {\"name\": \"Speculate\"},\n    }\n    return json.dumps(plugin_data, indent=2) + \"\\n\"\n```\n\n**Files**: cli/src/speculate/cli/cli_commands.py\n**Spec**: cli/docs/project/specs/active/plan-2026-01-03-claude-code-plugin-support.md","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T21:14:28.297686833Z","created_by":"Claude","updated_at":"2026-01-03T21:14:28.297686833Z","dependencies":[{"issue_id":"speculate-8qa","depends_on_id":"speculate-owz","type":"blocks","created_at":"2026-01-03T21:14:28.315941961Z","created_by":"unknown"}]}
{"id":"speculate-afk","title":"Integrate Claude plugin check into status() command","description":"Modify status() function to display Claude plugin status:\n\nAdd after the existing tool config checks (~line 330):\n\n```python\n# Check Claude Code plugin\nclaude_plugin = cwd / CLAUDE_PLUGIN_DIR\nif claude_plugin.exists():\n    commands_dir = claude_plugin / \"commands\"\n    if commands_dir.exists():\n        command_count = len(list(commands_dir.glob(\"*.md\")))\n        print_success(f\"{CLAUDE_PLUGIN_DIR}/ exists ({command_count} commands)\")\n    else:\n        print_warning(f\"{CLAUDE_PLUGIN_DIR}/ exists but has no commands\")\nelse:\n    print_info(f\"{CLAUDE_PLUGIN_DIR}/ not configured\")\n```\n\n**Files**: cli/src/speculate/cli/cli_commands.py\n**Spec**: cli/docs/project/specs/active/plan-2026-01-03-claude-code-plugin-support.md\n**Depends on**: speculate-owz (constants)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T21:15:54.91815474Z","created_by":"Claude","updated_at":"2026-01-03T21:15:54.91815474Z","dependencies":[{"issue_id":"speculate-afk","depends_on_id":"speculate-owz","type":"blocks","created_at":"2026-01-03T21:15:54.936905233Z","created_by":"unknown"}]}
{"id":"speculate-bpb","title":"Implement _remove_claude_plugin() function","description":"Add function to remove .claude/plugins/speculate/:\n\n```python\ndef _remove_claude_plugin(project_root: Path) -\u003e None:\n    \"\"\"Remove .claude/plugins/speculate/ directory.\n    Only removes the speculate plugin, not other plugins or .claude/ content.\n    Cleans up empty parent directories if possible.\n    \"\"\"\n    plugin_dir = project_root / CLAUDE_PLUGIN_DIR\n    if not plugin_dir.exists():\n        return\n    \n    shutil.rmtree(plugin_dir)\n    print_success(f\"Removed {CLAUDE_PLUGIN_DIR}/\")\n    \n    # Clean up empty parent directories\n    plugins_dir = plugin_dir.parent\n    if plugins_dir.exists() and not any(plugins_dir.iterdir()):\n        plugins_dir.rmdir()\n    \n    claude_dir = plugins_dir.parent\n    if claude_dir.exists() and not any(claude_dir.iterdir()):\n        claude_dir.rmdir()\n```\n\n**Files**: cli/src/speculate/cli/cli_commands.py\n**Spec**: cli/docs/project/specs/active/plan-2026-01-03-claude-code-plugin-support.md","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T21:15:10.719645807Z","created_by":"Claude","updated_at":"2026-01-03T21:15:10.719645807Z","dependencies":[{"issue_id":"speculate-bpb","depends_on_id":"speculate-owz","type":"blocks","created_at":"2026-01-03T21:15:10.737079508Z","created_by":"unknown"}]}
{"id":"speculate-jnv","title":"Implement _generate_skill_md() function","description":"Add function to generate SKILL.md routing skill content. Reads shortcut names and creates trigger table mapping user intents to /speculate:command invocations.\n\nKey elements:\n- Trigger table mapping task types to commands\n- Common workflow chains (Full Feature Flow, Commit Flow)\n- Usage instructions for announcement and invocation\n\nSee plan spec for full implementation details.\n\n**Files**: cli/src/speculate/cli/cli_commands.py\n**Spec**: cli/docs/project/specs/active/plan-2026-01-03-claude-code-plugin-support.md","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T21:14:42.552655013Z","created_by":"Claude","updated_at":"2026-01-03T21:14:42.552655013Z","dependencies":[{"issue_id":"speculate-jnv","depends_on_id":"speculate-owz","type":"blocks","created_at":"2026-01-03T21:14:42.56859026Z","created_by":"unknown"}]}
{"id":"speculate-owz","title":"Add Claude plugin constants to cli_commands.py","description":"Add constants for Claude Code plugin configuration at top of cli_commands.py:\n\n```python\n# Claude Code plugin configuration\nCLAUDE_PLUGIN_NAME = \"speculate\"\nCLAUDE_PLUGIN_DIR = f\".claude/plugins/{CLAUDE_PLUGIN_NAME}\"\nCLAUDE_PLUGIN_VERSION = \"1.0.0\"\nCLAUDE_PLUGIN_DESCRIPTION = (\n    \"Spec-driven development workflows: planning, implementation, commits, PRs, and code review\"\n)\n```\n\nAlso add `import json` to imports.\n\n**Files**: cli/src/speculate/cli/cli_commands.py\n**Spec**: cli/docs/project/specs/active/plan-2026-01-03-claude-code-plugin-support.md","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T21:14:16.430889464Z","created_by":"Claude","updated_at":"2026-01-03T21:14:16.430889464Z","dependencies":[{"issue_id":"speculate-owz","depends_on_id":"speculate-tj4","type":"discovered-from","created_at":"2026-01-03T21:14:16.436770344Z","created_by":"unknown"}]}
{"id":"speculate-tj4","title":"Claude Code plugin support for Speculate CLI","description":"Implement Claude Code plugin support in the Speculate CLI.\n\n**Plan Spec**: cli/docs/project/specs/active/plan-2026-01-03-claude-code-plugin-support.md\n\n**Goal**: Extend speculate install to create .claude/plugins/speculate/ with:\n- Symlinks to shortcuts as /speculate:command-name commands\n- Generated routing skill for automatic triggering\n- plugin.json manifest\n\n**Research Brief**: docs/general/research/current/research-coding-agent-skills-commands-extensions.md","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-03T21:13:43.801733362Z","created_by":"Claude","updated_at":"2026-01-03T21:13:43.801733362Z"}
{"id":"speculate-y1t","title":"Integrate _remove_claude_plugin into uninstall() command","description":"Modify uninstall() function to handle Claude plugin removal:\n\n1. Add to preview section (~line 639):\n```python\n# Check for Claude plugin\nclaude_plugin = cwd / CLAUDE_PLUGIN_DIR\nif claude_plugin.exists():\n    command_count = len(list((claude_plugin / \"commands\").glob(\"*.md\")))\n    changes.append(f\"Remove {CLAUDE_PLUGIN_DIR}/ ({command_count} commands)\")\n```\n\n2. Add to removal section (after _remove_cursor_rules):\n```python\n# Remove Claude plugin\n_remove_claude_plugin(cwd)\n```\n\n**Files**: cli/src/speculate/cli/cli_commands.py\n**Spec**: cli/docs/project/specs/active/plan-2026-01-03-claude-code-plugin-support.md\n**Depends on**: speculate-bpb (_remove_claude_plugin function)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T21:15:42.765479161Z","created_by":"Claude","updated_at":"2026-01-03T21:15:42.765479161Z","dependencies":[{"issue_id":"speculate-y1t","depends_on_id":"speculate-bpb","type":"blocks","created_at":"2026-01-03T21:15:42.780707202Z","created_by":"unknown"}]}
